-- 引入所有公式
-- 初始化所有变量
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local originalWalkSpeed = humanoid.WalkSpeed

-- 状态变量
local Fu_Ling_Sik_1 = 0  -- 穿墙：0 = 开启，1 = 关闭
local Fu_Ling_Sik_2 = 0  -- 特效：0 = 开启，1 = 关闭
local Fu_Ling_Sik_3 = 0   -- 移动速度修改：0 = 使用自定义值，1 = 使用原值
local Player_movement_speed_value = 100
local Special_effects_colors = Color3.new(0.1, 0, 0)  -- 默认血黑色

-- 穿墙功能
local originalCollisionGroups = {}

local function disableCollisions()
	for _, part in ipairs(character:GetDescendants()) do
		if part:IsA("BasePart") then
			originalCollisionGroups[part] = part.CollisionGroup
			part.CanCollide = false
			part.CollisionGroup = "NoCollision"
		end
	end
end

local function enableCollisions()
	for part, group in pairs(originalCollisionGroups) do
		if part and part.Parent then
			part.CanCollide = true
			part.CollisionGroup = group
		end
	end
	originalCollisionGroups = {}
end

-- 特效功能
local FIRE_SIZE = 5

local function addColoredFire(part, color)
	if part:FindFirstChild("ColoredFire") then
		part.ColoredFire:Destroy()
	end
	local fire = Instance.new("Fire")
	fire.Name = "ColoredFire"
	fire.Size = FIRE_SIZE
	fire.Heat = 3
	fire.Color = color
	fire.Parent = part
end

local function addColoredFiresToCharacter(char)
	for _, part in ipairs(char:GetChildren()) do
		if part:IsA("BasePart") then
			addColoredFire(part, Special_effects_colors)
		end
	end
end

local function removeAllColoredFires(char)
	for _, part in ipairs(char:GetDescendants()) do
		if part:IsA("Fire") and part.Name == "ColoredFire" then
			part:Destroy()
		end
	end
end

-- 角色重生处理
local function onCharacterAdded(newCharacter)
	character = newCharacter
	humanoid = character:WaitForChild("Humanoid")
	originalWalkSpeed = humanoid.WalkSpeed

	-- 穿墙
	if Fu_Ling_Sik_1 == 0 then
		disableCollisions()
	else
		enableCollisions()
	end

	-- 特效
	if Fu_Ling_Sik_2 == 0 then
		addColoredFiresToCharacter(character)
	else
		removeAllColoredFires(character)
	end

	-- 移动速度
	if Fu_Ling_Sik_3 == 0 then
		humanoid.WalkSpeed = Player_movement_speed_value
	else
		humanoid.WalkSpeed = originalWalkSpeed
	end
end

-- 初始加载
onCharacterAdded(character)
player.CharacterAdded:Connect(onCharacterAdded)

-- 显示欢迎弹窗
player:WaitForChild("PlayerGui")
game.StarterGui:SetCore("SendNotification", {
	Title = "歡迎使用",
	Text = "作者 快手號:4708518336",
	Duration = 5
})

-- 加载 OrionLib
local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/refs/heads/main/scripting_framework.lua"))()

local Window = OrionLib:MakeWindow({
	IntroText = "宇宙",
	Name = "宇宙" .. (identifyexecutor and identifyexecutor() or ""),
	HidePremium = false,
	SaveConfig = true,
	ConfigFolder = "OrionConfig_宇宙"
})

-- 首页
local Tab = Window:MakeTab({
	Name = "首頁",
	Icon = "rbxassetid://4458855809",
	PremiumOnly = false
})

Tab:AddButton({
	Name = "作者 快手號:4708518336",
	Callback = function()
		getgenv().XiaoPi = "作者 快手號:4708518336"
		loadstring(game:HttpGet("https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_simple"))()
	end
})

-- 玩家
local Tab = Window:MakeTab({
	Name = "玩家",
	Icon = "rbxassetid://4458855809",
	PremiumOnly = false
})

Tab:AddToggle({
	Name = "移動速度修改",
	Default = false,
	Callback = function()
		getgenv().XiaoPi = "移動速度修改"
		Fu_Ling_Sik_3 = 1 - Fu_Ling_Sik_3  -- 切换状态
	end
})

local speeds = {16, 25, 50, 75, 100}
for _, speed in ipairs(speeds) do
	Tab:AddButton({
		Name = "移動速度修改(" .. speed .. ")",
		Callback = function()
			getgenv().XiaoPi = "移動速度修改(" .. speed .. ")"
			Player_movement_speed_value = speed
			if Fu_Ling_Sik_3 == 0 then
				humanoid.WalkSpeed = speed
			end
		end
	})
end

Tab:AddToggle({
	Name = "穿牆",
	Default = false,
	Callback = function()
		getgenv().XiaoPi = "穿牆"
		Fu_Ling_Sik_1 = 1 - Fu_Ling_Sik_1
		if Fu_Ling_Sik_1 == 0 then
			disableCollisions()
		else
			enableCollisions()
		end
	end
})

Tab:AddToggle({
	Name = "特效",
	Default = false,
	Callback = function()
		getgenv().XiaoPi = "特效"
		Fu_Ling_Sik_2 = 1 - Fu_Ling_Sik_2
		if Fu_Ling_Sik_2 == 0 then
			addColoredFiresToCharacter(character)
		else
			removeAllColoredFires(character)
		end
	end
})

local colors = {
	{"藍色", Color3.new(0, 0, 1)},
	{"黃色", Color3.new(1, 1, 0)},
	{"白色", Color3.new(1, 1, 1)},
	{"血黑色", Color3.new(0.1, 0, 0)}
}

for _, colorInfo in ipairs(colors) do
	local name, color = colorInfo[1], colorInfo[2]
	Tab:AddButton({
		Name = "改變特效顏色(" .. name .. ")",
		Callback = function()
			getgenv().XiaoPi = "改變特效顏色(" .. name .. ")"
			Special_effects_colors = color
			if Fu_Ling_Sik_2 == 0 then
				addColoredFiresToCharacter(character)
			end
		end
	})
end

-- 功能
local Tab = Window:MakeTab({
	Name = "功能",
	Icon = "rbxassetid://7733779610",
	PremiumOnly = false
})

local function addFunctionButton(tab, name, url)
	tab:AddButton({
		Name = name,
		Callback = function()
			getgenv().XiaoPi = name
			loadstring(game:HttpGet(url))()
		end
	})
end

addFunctionButton(Tab, "飛行", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_flight")
addFunctionButton(Tab, "自動旋轉", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_auto-rotation")
addFunctionButton(Tab, "飛行(超人動畫)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_superman_flight")
addFunctionButton(Tab, "甩飛腳本(肘擊)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_throw_away")

-- 武器獲得
local Tab = Window:MakeTab({
	Name = "武器獲得",
	Icon = "rbxassetid://7825183411",
	PremiumOnly = false
})

addFunctionButton(Tab, "傳送工具", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/scrript_click-to-deliver")
addFunctionButton(Tab, "破壞之錘(可以破壞地圖的方塊)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_hammer_destruction")
addFunctionButton(Tab, "火箭筒", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_bazooka")

-- 擴展菜單
local Tab = Window:MakeTab({
	Name = "擴展菜單",
	Icon = "rbxassetid://133104953772161",
	PremiumOnly = false
})

addFunctionButton(Tab, "dex(修改器)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_dex")
addFunctionButton(Tab, "動作跳舞菜單(R15)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_action_menu")
addFunctionButton(Tab, "透視菜單", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_EFP")
addFunctionButton(Tab, "物體控制菜單", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_controlled_items")
addFunctionButton(Tab, "地圖貼圖修改", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_map_change")

-- 最強戰場
local Tab = Window:MakeTab({
	Name = "最強戰場",
	Icon = "rbxassetid://111934201357670",
	PremiumOnly = false
})

addFunctionButton(Tab, "特效", "https://raw.githubusercontent.com/IdkRandomUsernameok/PublicAssets/refs/heads/main/Releases/MUI/Mua")
addFunctionButton(Tab, "五条悟(最強英雄)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_gojo_satoru_all.lua")
addFunctionButton(Tab, "五条悟2(最強英雄)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/refs/heads/main/script_gojo_satoru_2.lua")
addFunctionButton(Tab, "火車頭(英雄獵人)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_the_flash_all.lua")

-- 偷走一顆腦紅
local Tab = Window:MakeTab({
	Name = "偷走一顆腦紅",
	Icon = "rbxassetid://111934201357670",
	PremiumOnly = false
})

addFunctionButton(Tab, "菜單(修改)", "https://raw.githubusercontent.com/jingbof50-lab/roblox_universe_script/main/script_Property_modification_menu")

-- 移动速度循环更新
while true do
	wait(0.1)
	if character and humanoid and humanoid.Health > 0 then
		if Fu_Ling_Sik_3 == 0 then
			humanoid.WalkSpeed = Player_movement_speed_value
		else
			humanoid.WalkSpeed = originalWalkSpeed
		end
	end
end
